Balam: Vulnerability Probe v2.0
Table of Contents
About Balam

Features

Installation

Prerequisites

Python Dependencies

External Tools

Usage

Command-Line Arguments

Examples

Output

Important Notes & Probing Tips

License

About Balam
Balam, named after the demon who speaks truthfully of vulnerabilities, is an advanced vulnerability assessment and deep analysis tool designed for bug bounty hunting. It serves as "Phase 2" of a comprehensive reconnaissance and exploitation workflow, building upon the outputs of an initial reconnaissance phase (like "Andromalius" or similar tools that generate live_hosts.json).

Balam focuses on active probing and detailed analysis to uncover technical and business risks, combining various techniques for a robust vulnerability assessment.

Features
Balam performs a wide array of active vulnerability checks and analyses:

üîç Phase A: Network Reconnaissance
Nmap Port Scanning: Conducts comprehensive TCP SYN, service version detection, and OS detection scans on identified live hosts.

Nmap Vulnerability Script Scan: Runs Nmap's built-in vulnerability scripts against common ports to identify known weaknesses.

üåê Phase B: Web Application Assessment
Gobuster Directory Brute Forcing: Discovers hidden directories and files on web services using common wordlists.

FFUF Fuzzing: Performs advanced content discovery and parameter probing using multiple wordlists (common, API, backup).

Nuclei Vulnerability Scanning: Leverages Nuclei templates to scan for a wide range of web vulnerabilities (CVEs, misconfigurations, default credentials, etc.).

SSL/TLS Analysis: Evaluates SSL/TLS configurations for weak ciphers, outdated protocols, and certificate expiry issues.

üéØ Phase C: Vulnerability Discovery
Custom Vulnerability Checks: Implements basic checks for exposed sensitive files (.git/config, .env, phpinfo.php), directory traversal, and basic SQL injection.

Subdomain Takeover Check: Identifies potential subdomain takeover vulnerabilities by checking CNAME records against known vulnerable service signatures.

Technology-Specific Checks: Performs targeted vulnerability checks based on identified technologies (e.g., WordPress, Drupal, PHP, Apache/Nginx common exposures).

CORS Misconfiguration Check: Probes for Cross-Origin Resource Sharing (CORS) misconfigurations that could lead to data leakage or other attacks.

Exposed VCS (.git/.svn) Check: Scans for publicly accessible Version Control System (VCS) directories that might expose sensitive source code or configurations.

Known Technology Vulnerabilities: Checks for common vulnerabilities associated with detected web technologies.

Common URL Parameter Probing: Tests various common URL parameters with payloads for Open Redirect, Reflected XSS, basic SQLi, and LFI.

Email Harvesting: Attempts to collect emails from WHOIS information (loaded from input) and open sources using theHarvester (if installed).

üìä Reporting
Comprehensive Report Generation: Creates a detailed human-readable report summarizing all findings, statistics, and recommendations for further manual testing and remediation priorities.

Organized Output: Saves all discovered data and findings into a structured output directory.

Installation
Prerequisites
Balam is a Python 3 script and requires certain external tools to be installed on your system for full functionality.

Python 3: Ensure you have Python 3.x installed.

python3 --version

Python Dependencies
Install the required Python libraries using pip:

pip3 install requests urllib3 argparse dnspython

Note: dnspython is optional but recommended for enhanced DNS features. If not installed, some DNS-related functionalities might be limited.

External Tools
For full functionality, Balam relies on the following external command-line tools. Please ensure they are installed and available in your system's PATH. The script performs a check for these tools at startup.

nmap (Network scanner for port scanning and vulnerability scripts)

nuclei (Fast and customizable vulnerability scanner)

gobuster (Directory/file & DNS busting tool)

ffuf (Fast web fuzzer)

theHarvester (Optional, for email harvesting)

Installation Examples for External Tools (Linux/Debian-based):

# Install Nmap
sudo apt update
sudo apt install nmap

# Install Nuclei (Go-based, requires Go installed)
# go install -v github.com/projectdiscovery/nuclei/v2/cmd/nuclei@latest

# Install Gobuster (Go-based, requires Go installed)
# go install github.com/OJ/gobuster/v3@latest

# Install Ffuf (Go-based, requires Go installed)
# go install github.com/ffuf/ffuf@latest

# Install theHarvester
sudo apt install theharvester

Note: For Go-based tools, ensure your Go environment is set up correctly and $GOPATH/bin is in your $PATH.

Usage
Balam requires an input directory containing reconnaissance data, typically generated by a "Phase 1" tool like Paimon (or "Andromalius" as mentioned in the code's comments), specifically the live_hosts.json file.

python3 balam_vulnprobe.txt -i <input_directory> -o <output_directory> [OPTIONS]

Arguments:

-i, --input (Required): Input directory containing reconnaissance results (e.g., from Andromalius/Paimon). This directory must contain live_hosts.json.

-o, --output (Required): Output directory for Balam's vulnerability assessment results. Balam will create this directory if it doesn't exist.

-T, --threads (Optional): Number of threads to use for concurrent operations. Default is 30.

--timeout (Optional): HTTP timeout in seconds for web requests. Default is 15.

Examples
Run Balam using reconnaissance results from ./andromalius_results and save vulnerability findings to ./balam_results:

python3 balam_vulnprobe.txt -i ./andromalius_results -o ./balam_results

Run Balam with custom thread and timeout settings:

python3 balam_vulnprobe.txt -i ./recon -o ./vuln_scan -T 50 --timeout 20

Output
Balam organizes all its findings within the specified output directory. Key files generated include:

target_ips.txt: List of unique IP addresses resolved from live hosts.

nmap_scan.gnmap, nmap_scan.xml, etc.: Comprehensive Nmap scan results.

nmap_vulns.gnmap, nmap_vulns.xml, etc.: Nmap vulnerability script scan results.

gobuster_<hostname>.txt: Gobuster directory brute-forcing results for each host.

ffuf_output/: Directory containing FFUF fuzzing results (CSV format) for various wordlists and hosts.

nuclei_targets.txt: List of target URLs used by Nuclei.

nuclei_results.txt, nuclei_results.json: Nuclei scan results in text and JSON format.

ssl_analysis.json: Detailed JSON output of SSL/TLS security analysis results.

custom_vulns.json: JSON output of findings from custom vulnerability checks.

subdomain_takeovers.json: JSON output of potential subdomain takeover findings.

tech_specific_vulns.json: JSON output of technology-specific vulnerability findings.

cors_results.txt: Results from CORS misconfiguration checks.

exposed_vcs_results.txt: Results from exposed VCS checks.

known_tech_vulnerabilities.txt: Report on known vulnerabilities related to identified technologies.

parameter_probe_results.txt: Results from common URL parameter probing.

harvested_emails.txt: List of harvested email addresses.

theharvester_results.xml: Raw XML output from theHarvester (if used).

BALAM_VULNERABILITY_REPORT.txt: The final, human-readable report summarizing the entire assessment.

all_vulnerabilities.json: Consolidated JSON report of all identified vulnerabilities, categorized by severity.

Important Notes & Probing Tips
Prerequisite: Balam is designed to be run after a reconnaissance phase that generates a live_hosts.json file. Ensure this file is present in your input directory.

Automated vs. Manual: Balam provides automated active probing and initial vulnerability checks. Manual verification of all findings is crucial. Many automated findings can be false positives.

Scope: Always ensure you are operating within the defined scope of a bug bounty program.

Rate Limits: Be mindful of rate limits. Aggressive scanning with tools like Nuclei, Gobuster, or FFUF might trigger WAFs or IP bans. Adjust --threads and --timeout accordingly.

Permissions: Ensure you have proper permissions for network scanning tools like Nmap (often requires sudo or root privileges for certain scan types).

Focus on High-Impact: After initial scans, prioritize manual testing on critical and high-severity findings.

WAF/IDS/IPS: Be aware that Web Application Firewalls (WAFs), Intrusion Detection Systems (IDS), and Intrusion Prevention Systems (IPS) can detect and block automated scans. Adjust scan speed and techniques if encountering such defenses.

Wordlists: The script uses default wordlists for Gobuster and FFUF. You can override these using environment variables like FUZZ_WORDLIST, API_WORDLIST, BACKUP_WORDLIST if you have custom or larger wordlists.

Responsible Disclosure: Always follow responsible disclosure practices when reporting vulnerabilities.
